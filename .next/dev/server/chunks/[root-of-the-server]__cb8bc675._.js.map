{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Tejab/Desktop/final_year_project/TRACKSHEET/UI/lib/auth.ts"],"sourcesContent":["import jwt from \"jsonwebtoken\";\r\n\r\nexport type AuthTokenPayload = {\r\n  role: \"student\" | \"staff\";\r\n  rollNumber?: string;\r\n  staffId?: string;\r\n  email: string;\r\n};\r\n\r\nconst jwtSecret = process.env.JWT_SECRET;\r\nconst jwtExpiresIn = process.env.JWT_EXPIRES_IN || \"7d\";\r\n\r\nif (!jwtSecret) {\r\n  throw new Error(\"Missing JWT_SECRET in environment\");\r\n}\r\n\r\nexport function signAuthToken(payload: AuthTokenPayload) {\r\n  return jwt.sign(payload, jwtSecret, { expiresIn: jwtExpiresIn });\r\n}\r\n\r\nexport function verifyAuthToken(token: string): AuthTokenPayload {\r\n  return jwt.verify(token, jwtSecret) as AuthTokenPayload;\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;;AASA,MAAM,YAAY,QAAQ,GAAG,CAAC,UAAU;AACxC,MAAM,eAAe,QAAQ,GAAG,CAAC,cAAc,IAAI;AAEnD,IAAI,CAAC,WAAW;IACd,MAAM,IAAI,MAAM;AAClB;AAEO,SAAS,cAAc,OAAyB;IACrD,OAAO,kJAAG,CAAC,IAAI,CAAC,SAAS,WAAW;QAAE,WAAW;IAAa;AAChE;AAEO,SAAS,gBAAgB,KAAa;IAC3C,OAAO,kJAAG,CAAC,MAAM,CAAC,OAAO;AAC3B","debugId":null}},
    {"offset": {"line": 95, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Tejab/Desktop/final_year_project/TRACKSHEET/UI/lib/auth-server.ts"],"sourcesContent":["import { NextRequest } from \"next/server\";\r\nimport { AuthTokenPayload, verifyAuthToken } from \"./auth\";\r\n\r\nconst COOKIE_NAME = \"tracksheet_token\";\r\n\r\nexport function getAuthFromRequest(request: NextRequest): AuthTokenPayload | null {\r\n  const token = request.cookies.get(COOKIE_NAME)?.value;\r\n  if (!token) return null;\r\n  try {\r\n    return verifyAuthToken(token);\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport function getAuthCookieName() {\r\n  return COOKIE_NAME;\r\n}\r\n"],"names":[],"mappings":";;;;;;AACA;;AAEA,MAAM,cAAc;AAEb,SAAS,mBAAmB,OAAoB;IACrD,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,cAAc;IAChD,IAAI,CAAC,OAAO,OAAO;IACnB,IAAI;QACF,OAAO,IAAA,gIAAe,EAAC;IACzB,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,SAAS;IACd,OAAO;AACT","debugId":null}},
    {"offset": {"line": 120, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Tejab/Desktop/final_year_project/TRACKSHEET/UI/app/api/me/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\nimport { getAuthFromRequest } from \"@/lib/auth-server\";\r\n\r\nexport async function GET(request: NextRequest) {\r\n  const auth = getAuthFromRequest(request);\r\n  if (!auth) {\r\n    return NextResponse.json({ userId: null }, { status: 200 });\r\n  }\r\n\r\n  return NextResponse.json({\r\n    userId: auth.rollNumber || auth.staffId,\r\n    role: auth.role,\r\n    rollNumber: auth.rollNumber,\r\n    staffId: auth.staffId,\r\n    email: auth.email,\r\n  });\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,IAAI,OAAoB;IAC5C,MAAM,OAAO,IAAA,6IAAkB,EAAC;IAChC,IAAI,CAAC,MAAM;QACT,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,QAAQ;QAAK,GAAG;YAAE,QAAQ;QAAI;IAC3D;IAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;QACvB,QAAQ,KAAK,UAAU,IAAI,KAAK,OAAO;QACvC,MAAM,KAAK,IAAI;QACf,YAAY,KAAK,UAAU;QAC3B,SAAS,KAAK,OAAO;QACrB,OAAO,KAAK,KAAK;IACnB;AACF","debugId":null}}]
}